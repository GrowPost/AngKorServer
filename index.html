<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AngkorPS Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<style>
body { font-family:'Inter', sans-serif; margin:0; background:#0d1117; color:#e5e5e5; }
.header { display:flex; align-items:center; justify-content:space-between; padding:1rem 2rem; background:#11151c; border-bottom:1px solid #1f242c; position:relative; }
.header .title { display:flex; align-items:center; gap:.6rem; font-size:1.8rem; font-weight:700; color:#10b981; }
.header .title img { width:35px; height:35px; border-radius:8px; object-fit:cover; }
.menu-icon { font-size:1.6rem; cursor:pointer; color:#10b981; transition:.3s; }
.menu-icon:hover { color:#14d47a; }

/* PROFESSIONAL DROPDOWN */
.dropdown { 
  position:absolute; top:65px; right:20px; background:#11151c; border-radius:12px; 
  box-shadow:0 8px 20px rgba(0,0,0,0.4); overflow:hidden; display:none; flex-direction:column; min-width:200px; z-index:100; 
  transform:translateY(-10px); opacity:0; transition: all .3s ease;
}
.dropdown.show { display:flex; transform:translateY(0); opacity:1; }
.dropdown a { padding:1rem 1.2rem; color:#e5e5e5; text-decoration:none; display:flex; align-items:center; gap:.7rem; font-weight:500; transition:.3s; border-left:4px solid transparent; }
.dropdown a:hover { background:#10b981; color:#111; }
.dropdown a.active { border-left:4px solid #10b981; background:#161b23; }

.container { max-width:900px; margin:auto; padding:2rem 1rem; }
.card { background:#11151c; padding:1.5rem; border-radius:12px; border:1px solid #1f242c; box-shadow:0 2px 8px rgba(0,0,0,0.2); margin-bottom:1.5rem; display:none; }
.card.active { display:block; }
.status-card { display:flex; justify-content:space-between; align-items:center; margin-bottom:.8rem; padding:.8rem 1rem; border-radius:10px; background:#161b23; }
.status-card h4 { font-weight:500; color:#b5b5b5; }
.status-card p { font-weight:600; color:#10b981; }
.lb-item { display:flex; justify-content:space-between; align-items:center; padding:.6rem 1rem; margin-bottom:.4rem; background:#161b23; border-radius:8px; font-weight:500; color:#e5e5e5; }
.lb-wl { display:flex; align-items:center; gap:.35rem; }
.lb-wl img { width:18px; height:18px; object-fit:contain; }
.btn-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(150px,1fr)); gap:.8rem; margin-top:1rem; }
.btn { padding:.8rem; border-radius:10px; font-weight:500; font-size:.9rem; border:1px solid #222831; background:#1a1f26; color:#e5e5e5; cursor:pointer; transition:.2s; }
.btn:hover { background:#10b981; color:#111; border-color:#10b981; }
.btn-discord { background:#5865f2; border:none; color:#fff; }
.btn-discord:hover { opacity:.85; }
.footer { text-align:center; padding:2rem 0; color:#888; font-size:.9rem; }
.toast { position:fixed; bottom:30px; left:50%; transform:translateX(-50%) translateY(40px); background:#10b981; color:#fff; padding:.8rem 1.4rem; border-radius:10px; opacity:0; transition:.4s ease; pointer-events:none; font-size:.9rem; }
.toast.show { opacity:1; transform:translateX(-50%) translateY(0px); }
.toast.error { background:#d9534f; }
</style>
</head>
<body>

<header class="header">
  <div class="title">
    <img src="assets/AngkorPS.png" alt="Logo"> AngkorPS
  </div>
  <div class="menu-icon" id="menuIcon"><i class="fas fa-bars"></i></div>
</header>

<!-- PROFESSIONAL DROPDOWN MENU -->
<div class="dropdown" id="dropdownMenu">
  <a href="#" data-target="home" class="active"><i class="fas fa-home"></i> Home</a>
  <a href="#" data-target="leaderboard"><i class="fas fa-trophy"></i> Leaderboard</a>
  <a href="#" data-target="host"><i class="fas fa-server"></i> Host & Download</a>
  <a href="#" data-target="discord"><i class="fab fa-discord"></i> Discord</a>
</div>

<div class="container">
  <div id="home" class="card active">
    <div class="status-card"><h4>Server Status</h4><p id="serverStatus">Checking...</p></div>
    <div class="status-card"><h4>Players Online</h4><p id="playersCount">0</p></div>
  </div>

  <div id="leaderboard" class="card">
    <h3><i class="fas fa-trophy"></i> Leaderboard</h3>
    <ul id="leaderboardList"><li>Loading...</li></ul>
  </div>

  <div id="host" class="card">
    <h3><i class="fas fa-server"></i> Host & Download</h3>
    <div class="btn-grid">
      <button class="btn" onclick="copyHost()">Copy IP</button>
      <button class="btn" onclick="downloadHost()">Download Host</button>
      <button class="btn" onclick="copyPowerTunnel()">PowerTunnel</button>
      <button class="btn" onclick="copyHostGoURL()">Host GO</button>
      <button class="btn" onclick="copyIOS()">iOS Host</button>
    </div>
  </div>

  <div id="discord" class="card">
    <h3><i class="fab fa-discord"></i> Discord</h3>
    <button class="btn btn-discord" onclick="window.open('https://discord.gg/JrVquN9sgx')">Join Discord</button>
  </div>
</div>

<footer class="footer">Â© <strong>AngkorPS</strong></footer>
<div id="toast" class="toast"></div>

<script>
// TOGGLE DROPDOWN
const menuIcon = document.getElementById('menuIcon');
const dropdownMenu = document.getElementById('dropdownMenu');
menuIcon.addEventListener('click', ()=> dropdownMenu.classList.toggle('show'));

// MENU ITEM CLICK
const menuItems = dropdownMenu.querySelectorAll('a');
const cards = document.querySelectorAll('.card');
menuItems.forEach(item=>{
  item.addEventListener('click', (e)=>{
    e.preventDefault();
    const target = item.dataset.target;
    cards.forEach(c=> c.id===target ? c.classList.add('active') : c.classList.remove('active'));
    
    // Highlight active menu
    menuItems.forEach(i=>i.classList.remove('active'));
    item.classList.add('active');
    
    dropdownMenu.classList.remove('show');
  });
});

// TOAST FUNCTION
function showToast(msg, type="success") {
  const t = document.getElementById("toast");
  t.textContent = msg;
  t.className = "toast " + (type==="error"?"error":"");
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),1800);
}

// HOST FUNCTIONS
const HOST_IP_TEXT = `5.39.13.21 growtopia1.com
5.39.13.21 growtopia2.com
5.39.13.21 www.growtopia1.com
5.39.13.21 www.growtopia2.com`;
function copyText(text){ navigator.clipboard.writeText(text).then(()=>showToast("Copied")).catch(()=>showToast("Failed","error")); }
function copyHost(){ copyText(HOST_IP_TEXT); }
function copyPowerTunnel(){ copyText("https://angkorps.site/angkor.txt"); }
function copyHostGoURL(){ copyText("https://angkorps.site/angkor.host"); }
function copyIOS(){ copyText("https://angkorps.site/ios.txt"); }
function downloadHost(){ const blob=new Blob([HOST_IP_TEXT],{type:"text/plain"}); const url=URL.createObjectURL(blob); const a=document.createElement("a"); a.href=url; a.download="angkor.host"; a.click(); URL.revokeObjectURL(url); showToast("Downloaded!"); }

/* SERVER STATUS & LEADERBOARD */
async function updateServer(){
  try{
    const res = await fetch("https://angkorps.site/api/ping");
    const data = await res.json();
    document.getElementById("serverStatus").textContent = data.serverStatus==="online"?"ONLINE":"OFFLINE";
    document.getElementById("serverStatus").style.color = data.serverStatus==="online"?"#10b981":"red";
    document.getElementById("playersCount").textContent = data.onlinePlayersCount ?? 0;

    const lb = document.getElementById("leaderboardList"); lb.innerHTML="";
    if(data.leaderboard && data.leaderboard.length>0){
      data.leaderboard.forEach(entry=>{
        const parts = entry.split(" "); const rank=parts[0], name=parts[1], amount=parts[2], wlText=parts[3];
        const li=document.createElement("li");
        li.className="lb-item";
        li.innerHTML=`<span>${rank} ${name}</span><span class="lb-wl">${amount} ${wlText}<img src="assets/world_lock.png" alt="WL"></span>`;
        lb.appendChild(li);
      });
    } else lb.innerHTML="<li>No players found</li>";
  } catch {
    document.getElementById("serverStatus").textContent="OFFLINE";
    document.getElementById("serverStatus").style.color="red";
    document.getElementById("playersCount").textContent=0;
    document.getElementById("leaderboardList").innerHTML="<li>No data</li>";
  }
}

updateServer();
setInterval(updateServer,5000);
</script>

</body>
</html>
