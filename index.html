<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="AngkorPS Growtopia Private Server Dashboard">
<title>AngkorPS Dashboard</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

<!-- Favicon -->
<link rel="icon" href="assets/AngkorPS.png" type="image/png">

<style>
/* RESET */
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: 'Inter', sans-serif; background: #0d1117; color: #e5e5e5; }

/* HEADER / TOPBAR */
.topbar {
  width: 100%;
  background: #0f1319;
  border-bottom: 1px solid #1b1f27;
  padding: 0.9rem 1.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.topbar-left {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.topbar-left .logo {
  width: 44px;
  height: 44px;
  border-radius: 8px;
  object-fit: cover;
}

.topbar-left h1 {
  font-size: 1.5rem;
  margin: 0;
  color: #10b981;
  font-weight: 700;
}

.topbar-left p {
  font-size: 0.85rem;
  color: #b5b5b5;
  margin-top: 2px;
}

.nav-btn {
  padding: 0.6rem 1rem;
  background: #161b23;
  color: #e5e5e5;
  border: 1px solid #262c36;
  border-radius: 8px;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: .2s;
  display: flex;
  align-items: center;
  gap: .5rem;
}

.nav-btn:hover {
  background: #10b981;
  color: #111;
  border-color: #10b981;
}

/* MAIN CONTAINER */
.container { max-width: 1000px; margin: auto; padding: 1rem; }

/* CARD BASE */
.card { background:#11151c; padding:1.5rem; border-radius:12px; border:1px solid #1f242c; margin-bottom:1.4rem; box-shadow:0 2px 8px rgba(0,0,0,0.2); }

/* STATUS CARD */
.status-card {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:.8rem;
  padding:.8rem 1rem;
  border-radius:10px;
  background:#161b23;
}
.status-card h4 { font-weight:500; font-size:1rem; color:#b5b5b5; }
.status-card p { font-weight:600; font-size:1.2rem; }

/* LEADERBOARD */
.leaderboard h3 { font-size:1.1rem; font-weight:600; color:#fff; margin-bottom:.8rem; display:flex; align-items:center; gap:.5rem; }
ul { list-style:none; padding:0; }

.lb-item {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:.6rem 1rem;
  margin-bottom:.4rem;
  background:#161b23;
  border-radius:8px;
  font-weight:500;
}

.lb-wl { display:flex; align-items:center; gap:.35rem; }
.lb-wl img { width:18px; height:18px; }

/* BUTTON GRID */
.btn-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(150px, 1fr)); gap:.8rem; }
.btn { padding:.8rem; border-radius:10px; font-weight:500; font-size:.9rem; border:1px solid #222831; background:#1a1f26; cursor:pointer; transition:.2s; }
.btn:hover { background:#10b981; color:#111; border-color:#10b981; }

.btn-discord { background:#5865f2; border:none; }
.btn-discord:hover { opacity:.85; }

/* FOOTER */
.footer { text-align:center; padding:2rem 0; color:#888; font-size:0.9rem; }

/* TOAST */
.toast {
  position:fixed;
  bottom:30px;
  left:50%;
  transform:translateX(-50%) translateY(40px);
  background:#10b981;
  color:#fff;
  padding:.8rem 1.4rem;
  border-radius:10px;
  opacity:0;
  transition:.4s ease;
  pointer-events:none;
  font-size:.9rem;
}
.toast.show { opacity:1; transform:translateX(-50%) translateY(0px); }
.toast.error { background:#d9534f; }

/* PLAYER STATS PANEL */
.stats-panel {
    background: #0D1117;
    padding: 28px;
    border-radius: 14px;
    border: 1px solid #1F2937;
    margin-bottom: 20px;
}

.stats-panel .panel-title {
    color: #E5E7EB;
    font-size: 26px;
    font-weight: 600;
    margin-bottom: 22px;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 18px;
}

.stat-card {
    background: #111827;
    padding: 22px;
    border-radius: 12px;
    border: 1px solid #1F2937;
    text-align: left;
}

.stat-card h3 {
    color: #9CA3AF;
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.stat-card p {
    color: #F9FAFB;
    font-size: 28px;
    font-weight: 700;
}
</style>
</head>
<body>

<!-- HEADER -->
<header class="topbar">
  <div class="topbar-left">
    <img src="assets/AngkorPS.png" class="logo">
    <div>
      <h1>AngkorPS</h1>
      <p>Growtopia private server — stable, fast and enjoyable</p>
    </div>
  </div>

  <button class="nav-btn" onclick="window.location='pannel.html'">
    <i class="fas fa-bullhorn"></i> Announcements
  </button>
</header>

<div class="container">

  <!-- SERVER STATUS -->
  <div class="card">
    <div class="status-card">
      <h4>Server Status</h4>
      <p id="serverStatus">Checking...</p>
    </div>
    <div class="status-card">
      <h4>Players Online</h4>
      <p id="playersCount">0</p>
    </div>
  </div>

  <!-- PLAYER STATISTICS PANEL -->
  <div class="stats-panel">
    <h2 class="panel-title">Player Online Statistics</h2>
    <div class="stats-grid">
        <div class="stat-card">
            <h3>Total Players Online</h3>
            <p id="totalOnline">—</p>
        </div>
        <div class="stat-card">
            <h3>Players in Worlds</h3>
            <p id="worldPlayers">—</p>
        </div>
        <div class="stat-card">
            <h3>New Players Today</h3>
            <p id="newToday">—</p>
        </div>
        <div class="stat-card">
            <h3>Peak Online (24h)</h3>
            <p id="peakOnline">—</p>
        </div>
    </div>
  </div>

  <!-- LEADERBOARD -->
  <div class="card leaderboard">
    <h3><i class="fas fa-trophy"></i> Leaderboard</h3>
    <ul id="leaderboardList">
      <li>Loading...</li>
    </ul>
  </div>

  <!-- HOST & DOWNLOAD -->
  <div class="card">
    <h3><i class="fas fa-server"></i> Host & Download</h3>
    <div class="btn-grid">
      <button class="btn" onclick="copyHost()">Copy IP</button>
      <button class="btn" onclick="downloadHost()">Download Host</button>
      <button class="btn" onclick="copyPowerTunnel()">PowerTunnel</button>
      <button class="btn" onclick="copyHostGoURL()">Host GO</button>
      <button class="btn" onclick="copyIOS()">iOS Host</button>
    </div>
  </div>

  <!-- DISCORD -->
  <div class="card">
    <h3><i class="fab fa-discord"></i> Discord</h3>
    <div class="btn-grid">
      <button class="btn btn-discord" onclick="window.open('https://discord.gg/JrVquN9sgx')">Join Discord</button>
    </div>
  </div>

</div>

<footer class="footer">© <strong>AngkorPS</strong></footer>
<div id="toast" class="toast"></div>

<script>
function showToast(msg, type="success") {
  const t = document.getElementById("toast");
  t.textContent = msg;
  t.className = "toast " + (type === "error" ? "error" : "");
  t.classList.add("show");
  setTimeout(() => t.classList.remove("show"), 1800);
}

const HOST_IP_TEXT = `5.39.13.21 growtopia1.com
5.39.13.21 growtopia2.com
5.39.13.21 www.growtopia1.com
5.39.13.21 www.growtopia2.com`;

function copyText(text){
  navigator.clipboard.writeText(text).then(()=>showToast("Copied")).catch(()=>showToast("Failed","error"));
}
function copyHost(){ copyText(HOST_IP_TEXT); }
function copyPowerTunnel(){ copyText("https://angkorps.site/angkor.txt"); }
function copyHostGoURL(){ copyText("https://angkorps.site/angkor.host"); }
function copyIOS(){ copyText("https://angkorps.site/ios.txt"); }
function downloadHost(){
  const blob = new Blob([HOST_IP_TEXT], {type:"text/plain"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url; a.download="angkor.host"; a.click();
  URL.revokeObjectURL(url); showToast("Downloaded!");
}

/* SERVER STATUS & LEADERBOARD & PLAYER STATISTICS */
async function updateServer(){
  try{
    const res = await fetch("https://angkorps.site/api/ping");
    const data = await res.json();

    // Server Status
    document.getElementById("serverStatus").textContent =
      data.serverStatus === "online" ? "ONLINE" : "OFFLINE";
    document.getElementById("serverStatus").style.color =
      data.serverStatus === "online" ? "#10b981" : "red";

    // Total Players
    const total = data.onlinePlayersCount ?? 0;
    document.getElementById("playersCount").textContent = total;
    document.getElementById("totalOnline").textContent = total;

    // World Players (example)
    document.getElementById("worldPlayers").textContent = data.worldPlayers ?? 0;

    // New Today
    document.getElementById("newToday").textContent = data.newPlayersToday ?? 0;

    // Peak 24h
    document.getElementById("peakOnline").textContent = data.peakOnline24h ?? 0;

    // Leaderboard
    const lb = document.getElementById("leaderboardList");
    lb.innerHTML = "";
    if(data.leaderboard && data.leaderboard.length > 0){
      data.leaderboard.forEach((entry) => {
        const parts = entry.split(" ");
        const rank = parts[0];
        const name = parts[1];
        const amount = parts[2];
        const wlText = parts[3];

        const li = document.createElement("li");
        li.className = "lb-item";
        li.innerHTML = `<span>${rank} ${name}</span><span class="lb-wl">${amount} ${wlText} <img src="assets/world_lock.png" alt="WL"></span>`;
        lb.appendChild(li);
      });
    } else {
      lb.innerHTML = "<li>No players found</li>";
    }

  } catch {
    document.getElementById("serverStatus").textContent="OFFLINE";
    document.getElementById("serverStatus").style.color="red";
    document.getElementById("playersCount").textContent=0;
    document.getElementById("totalOnline").textContent=0;
    document.getElementById("worldPlayers").textContent=0;
    document.getElementById("newToday").textContent=0;
    document.getElementById("peakOnline").textContent=0;
    document.getElementById("leaderboardList").innerHTML="<li>No data</li>";
  }
}

updateServer();
setInterval(updateServer,5000);
</script>
</body>
</html>
